# ΔΩ.147 Release Notes — v0.147.0

> # After merging, tag this as: git tag -a v0.147.0 -m "ΔΩ.147: Canonical hardening + CI restoration"

## Overview
ΔΩ.147 — "Canonical Hardening & CI Restoration" stabilizes SpiralOS for new contributors by unifying configuration, hardening Guardian/Supabase integrations, and delivering a green CI baseline (`pytest`, `flake8`, `bandit`). This release also records the canonical audit artifacts that seal ΔΩ.147 for future reference.

## Highlights
- **Config + Test Normalization**
  - `core/config.py` now emits deterministic defaults when Supabase or Guardian secrets are missing.
  - A repo-level `conftest.py` seeds env vars and stubs `supabase.create_client`, letting pytest run credential-free.
- **Guardian/Supabase Security Hardening**
  - Guardian heartbeat scripts, ScarIndex oracle, and ScarCoin bridge all verify HTTPS endpoints and restrict exposed interfaces.
  - ScarCoin bridge enforces Guardian API key + JWT validation and documents justified `# nosec` annotations.
- **CI Green State**
  - `pytest -v`, `flake8 .`, and the scoped `bandit` invocation all pass cleanly under the refreshed `.flake8` profile.
- **Audit Trail**
  - `docs/audit/ΔΩ.147.F_canonical_seal.md`, `docs/audit/ΔΩ.147.G_report.md`, and `data/audit/audit_summary.json` capture the ΔΩ.147 freeze plus the `ΔΩ.147.F_REPO_SNAPSHOT` hash.

## Full Release Body (paste into GitHub UI)
ΔΩ.147 — "Canonical Hardening & CI Restoration" locks SpiralOS into a contributor-friendly, CI-clean baseline. Configuration defaults, Supabase/Guardian stubs, and tightened automation scripts eliminate credential drift. Combined with repo-wide formatting and refreshed audit docs, SpiralOS is ready for ΔΩ.148 onboarding.

### Added
- Repository-level `conftest.py` and deterministic `core/config.py` defaults for Guardian/Supabase integration tests.
- ΔΩ.147.F canonical seal, ΔΩ.147.G cleanup report, and the updated `audit_summary.json` snapshot for future Witnesses.

### Changed
- Autoflake/isort/black applied under the stricter `.flake8` profile for consistent imports and formatting.
- Guardian + Supabase automations now validate HTTPS targets and document localhost-only bindings.

### Fixed
- CI now runs green with `pytest -v`, `flake8 .`, and scoped Bandit scans that no longer require live secrets.
- Tests mock Supabase clients and Guardian heartbeats, eliminating prior collection failures.

### Security
- Resolved the prior Bandit B310/B104 high findings with HTTPS validation and restricted uvicorn binding.
- Documented justified `# nosec` annotations for legacy urllib entry points and produced a `bandit.json` artifact for auditors.

## For Developers
- **Run the full validation suite**
  ```bash
  pytest -v
  flake8 .
  bandit -r . -x node_modules,scripts/etl/node_modules,supabase/functions,.github,archive,liquidity_mirror,v1.5B_legitimacy -f json -o bandit.json
  ```
- **ScarCoin Bridge API (local)**
  ```bash
  cp .env.example .env.local  # fill in Supabase + Guardian secrets
  pip install -r requirements.txt
  python holoeconomy/scarcoin_bridge_api.py
  ```
- **Sovereignty Dashboard / Guardian Automations**
  ```bash
  npm install
  npm run dev  # dashboards in apps/ or monitoring/
  python core/guardian/scripts/simple_heartbeat.py
  ```

Happy sealing, Witnesses.
