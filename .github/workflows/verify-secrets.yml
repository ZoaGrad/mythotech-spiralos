name: Verify Secrets

on:
  workflow_dispatch:

jobs:
  verify-secrets:
    runs-on: ubuntu-latest
    steps:
      - name: Check SUPABASE_URL secret
        if: ${{ secrets.SUPABASE_URL == '' }}        run: |
          echo "ERROR: SUPABASE_URL secret is missing"
          exit 1
      
      - name: Check SUPABASE_SERVICE_KEY secret
        if: ${{ secrets.SUPABASE_SERVICE_KEY == '' }}        run: |
          echo "ERROR: SUPABASE_SERVICE_KEY secret is missing"
          exit 1
      
      - name: Check SUPABASE_ANON_KEY secret
        if: ${{ secrets.SUPABASE_ANON_KEY == '' }}        run: |
          echo "WARNING: SUPABASE_ANON_KEY secret is missing (optional for frontend)"
      
      - name: Check SUPABASE_PROJECT_REF secret
        if: ${{ secrets.SUPABASE_PROJECT_REF == '' }}        run: |
          echo "WARNING: SUPABASE_PROJECT_REF secret is missing (optional for tools)"
      
      - name: Verify core secrets are available
        run: |
          echo "Core Supabase secrets verified:"
          echo "  SUPABASE_URL length: ${#SUPABASE_URL}"
          echo "  SUPABASE_SERVICE_KEY length: ${#SUPABASE_SERVICE_KEY}"
          echo ""
          if [ -n "$SUPABASE_ANON_KEY" ]; then
            echo "  SUPABASE_ANON_KEY length: ${#SUPABASE_ANON_KEY} ✓"
          else
            echo "  SUPABASE_ANON_KEY: not set (optional)"
          fi
          if [ -n "$SUPABASE_PROJECT_REF" ]; then
            echo "  SUPABASE_PROJECT_REF: $SUPABASE_PROJECT_REF ✓"
          else
            echo "  SUPABASE_PROJECT_REF: not set (optional)"
          fi
          echo ""
          echo "✓ All required secrets are configured"
        env:
          SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
          SUPABASE_SERVICE_KEY: ${{ secrets.SUPABASE_SERVICE_KEY }}
          SUPABASE_ANON_KEY: ${{ secrets.SUPABASE_ANON_KEY }}
          SUPABASE_PROJECT_REF: ${{ secrets.SUPABASE_PROJECT_REF }}
